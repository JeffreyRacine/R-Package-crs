NOMAD4_ROOT = ./nomad4_src

# NOMAD 4 source list (mirrors CMake selection, excluding tool/openmp-only units).
NOMAD4_SRC_CPP = $(shell find $(NOMAD4_ROOT)/src -type f -name '*.cpp')
NOMAD4_SRC_CPP := $(filter-out $(NOMAD4_ROOT)/src/Attribute/WriteAttributeDefinitionFile.cpp,$(NOMAD4_SRC_CPP))
NOMAD4_SRC_CPP := $(filter-out $(NOMAD4_ROOT)/src/Algos/PSDMads/%,$(NOMAD4_SRC_CPP))
NOMAD4_SRC_CPP := $(filter-out $(NOMAD4_ROOT)/src/Algos/COOPMads/%,$(NOMAD4_SRC_CPP))

NOMAD4_SGTELIB_CPP = $(shell find $(NOMAD4_ROOT)/ext/sgtelib/src -type f -name '*.cpp')
NOMAD4_SGTELIB_CPP := $(filter-out $(NOMAD4_ROOT)/ext/sgtelib/src/sgtelib.cpp,$(NOMAD4_SGTELIB_CPP))
NOMAD4_SGTELIB_CPP := $(filter-out $(NOMAD4_ROOT)/ext/sgtelib/src/sgtelib_predict.cpp,$(NOMAD4_SGTELIB_CPP))
NOMAD4_CINT_CPP = $(NOMAD4_ROOT)/interfaces/CInterface/NomadStdCInterface.cpp

NOMAD4_OBJECTS = $(NOMAD4_SRC_CPP:.cpp=.o) $(NOMAD4_SGTELIB_CPP:.cpp=.o) $(NOMAD4_CINT_CPP:.cpp=.o)
NOMAD4_INCLUDE_DIRS = $(shell find $(NOMAD4_ROOT)/src -type d)
NOMAD4_INCLUDE_FLAGS = $(addprefix -I,$(NOMAD4_INCLUDE_DIRS))

OBJECTS = RuniqueCombs.o bspline.o gsl_bspline.o snomadr.o crs_init.o mgcv.o hat_diag.o $(NOMAD4_OBJECTS)

PKG_CXXFLAGS = $(NOMAD4_INCLUDE_FLAGS) -I$(NOMAD4_ROOT)/interfaces/CInterface -I$(NOMAD4_ROOT)/ext/sgtelib/src -DUSE_SGTELIB -DNOMAD_STATIC_BUILD
